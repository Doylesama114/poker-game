# 🚀 Sakura FRP 快速配置指南

## 📝 前置准备

1. 注册 [Sakura FRP 账号](https://www.natfrp.com/)
2. 下载并安装 [Sakura FRP 启动器](https://www.natfrp.com/tunnel/download)

## ⚡ 快速配置（5分钟）

### 步骤1：创建隧道（在 Sakura FRP 网站）

#### 隧道1：后端服务器
```
名称：card-game-backend
类型：TCP
本地地址：127.0.0.1
本地端口：3001
节点：选择延迟低的节点（如：上海）
远程端口：自动分配
```

#### 隧道2：前端网页
```
名称：card-game-frontend
类型：HTTP
本地地址：127.0.0.1
本地端口：5173
节点：同后端节点
域名：自动分配
```

### 步骤2：启动隧道

1. 打开 Sakura FRP 启动器
2. 登录账号
3. 在隧道列表中找到刚创建的两个隧道
4. 点击"启动"按钮
5. 确认状态显示"运行中"

### 步骤3：记录地址

启动成功后，记录分配的地址：

```
前端地址：http://abc123.natfrp.cloud
后端地址：http://cn-sh-bgp-1.natfrp.cloud:12345
```

**注意**：
- `abc123` 是示例，实际会是其他字符
- `12345` 是示例端口，实际会是其他数字

### 步骤4：更新配置

打开 `src/config/multiplayer.ts`，找到这一行：

```typescript
frp: 'http://localhost:3001', // 请替换为实际的FRP地址
```

替换为你的后端地址：

```typescript
frp: 'http://cn-sh-bgp-1.natfrp.cloud:12345',
```

### 步骤5：启动游戏

```bash
# 终端1：启动后端
cd server
node index.js

# 终端2：启动前端
pnpm run dev
```

### 步骤6：测试连接

1. 访问 FRP 前端地址：`http://abc123.natfrp.cloud`
2. 点击"联机对战"
3. 点击服务器地址旁的"配置"按钮
4. 选择"Sakura FRP"模式
5. 检查连接状态（应显示"✅ 已连接"）

### 步骤7：邀请朋友

1. 创建房间，记住房间ID
2. 告诉朋友访问：`http://abc123.natfrp.cloud`
3. 朋友加入房间（输入房间ID）
4. 开始游戏！🎮

## 🔧 故障排除

### 问题：显示"未连接"

**检查清单**：
- [ ] 后端服务正在运行（应看到"服务器运行在端口 3001"）
- [ ] FRP 后端隧道状态为"运行中"
- [ ] FRP 前端隧道状态为"运行中"
- [ ] 配置文件中的地址正确（包括端口号）

**解决方法**：
```bash
# 1. 检查后端
# 应该看到：服务器运行在端口 3001

# 2. 检查 FRP 隧道
# 在启动器中查看状态

# 3. 检查配置
# 打开 src/config/multiplayer.ts
# 确认 frp 地址正确
```

### 问题：朋友无法访问

**可能原因**：
1. FRP 隧道未启动
2. 地址输入错误
3. 朋友的网络问题

**解决方法**：
1. 确认 FRP 隧道运行中
2. 让朋友尝试访问：`http://你的前端地址`
3. 检查浏览器控制台是否有错误

### 问题：连接很慢

**优化建议**：
1. 选择延迟低的节点
2. 前后端使用同一节点
3. 考虑升级到付费节点

## 📊 配置对照表

| 项目 | 本地开发 | Sakura FRP |
|------|---------|-----------|
| 前端访问 | http://localhost:5173 | http://abc123.natfrp.cloud |
| 后端地址 | http://localhost:3001 | http://节点域名:远程端口 |
| 访问范围 | 仅本机 | 全球互联网 |

## 💡 提示

1. **保持 FRP 运行**：游戏期间，FRP 启动器必须保持运行
2. **记录地址**：把 FRP 地址保存下来，下次直接使用
3. **节点选择**：选择离你近的节点，延迟更低
4. **安全性**：不要分享你的 FRP Token

## 🎉 完成！

现在你可以邀请任何地方的朋友一起玩了！

---

**需要更详细的说明？** 查看 `SAKURA_FRP_GUIDE.md`
