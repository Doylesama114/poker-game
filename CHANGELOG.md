# 更新日志

## v1.0.0 - 稳定版本

### 新增功能

#### 核心游戏系统
- ✅ 完整的15张卡牌系统
- ✅ 三种卡牌类型：单位、环境、战术
- ✅ 复杂的效果系统（部署、持续、条件、叠加效果）
- ✅ 槽位选择机制
- ✅ 目标选择系统
- ✅ 重铸系统（恢复费用/换牌/战力+1）
- ✅ 单机AI对战模式

#### 联机系统
- ✅ WebSocket 实时对战
- ✅ 房间管理系统
- ✅ 联机大厅界面
- ✅ 操作同步机制
- ✅ 断线重连功能
- ✅ 标签页隔离（sessionStorage）
- ✅ 服务器配置系统
- ✅ Sakura FRP 内网穿透支持

### 修复的问题

#### 联机系统修复
1. **房间管理问题**
   - 修复第二个玩家加入后房间崩溃
   - 修复玩家名称显示 undefined
   - 修复 FRP 配置不保存
   - 实现房间信息持久化

2. **操作同步问题**（关键修复）
   - 修复 opponentAction 监听器设置错误
   - 确保回调函数正确调用
   - 修复操作能发送但不处理的问题

3. **卡牌显示问题**（关键修复）
   - 修复卡牌ID不匹配（_unique 后缀）
   - 修复对手卡牌无法显示
   - 实现从数据库获取卡牌数据

4. **对手手牌初始化**
   - 修复对手手牌随机生成导致的不一致
   - 使用占位符表示对手手牌
   - 打出时从数据库获取卡牌

5. **费用不足卡住**
   - 添加"跳过回合"功能
   - 费用为0时自动显示跳过按钮
   - 实现 skipTurn 操作同步

6. **离开游戏问题**
   - 修复离开游戏后自动重新加入
   - 清理 sessionStorage 房间信息
   - 返回主页而不是联机大厅

7. **最后一回合规则**（最终修复）
   - 修复填满场地立即结束游戏
   - 实现"对手再进行一回合"规则
   - 添加 finalRound 操作同步
   - 修复对手不知道游戏结束的问题

### 技术改进

- 实现标签页隔离机制（sessionStorage + tabId）
- 优化 Socket.IO 连接管理
- 添加详细的调试日志
- 改进错误处理
- 优化代码结构

### 文档

- 创建统一的项目文档（PROJECT_DOCUMENTATION.md）
- 整合所有开发历史和修复记录
- 添加完整的技术架构说明
- 提供详细的快速开始指南
- 编写常见问题解答

---

## v0.3.0 - 联机系统

### 新增功能
- Socket.IO 后端服务器
- 房间管理系统
- 联机大厅界面
- 联机游戏逻辑
- 服务器配置系统
- Sakura FRP 支持

---

## v0.2.0 - 完整卡牌系统

### 新增功能
- 15张复杂卡牌
- 卡牌类型系统（单位/环境/战术）
- 关键词系统
- 效果系统（部署/持续/条件）
- 槽位选择
- 目标选择
- 叠加效果（法师、战士、矮人铁匠）
- 效果管理器

---

## v0.1.0 - 基础游戏

### 新增功能
- 基础2人回合制游戏
- 8张简单卡牌
- 玩家 vs AI
- 基本游戏流程

---

## v0.0.1 - 项目初始化

### 新增功能
- 项目初始化
- 基础布局
- 开发环境配置

**发布日期**: 2024.01.31

---

**当前版本**: v1.0.0
**状态**: 稳定版本，所有核心功能已完成
